<div class="chatbot-section">
    <div class="chat-box">
        <div class="chat-box-header">
            <div class="operator-status">
                {{ operator.status }}
                <span class="operator-status-online">‚óè</span>
            </div>
            <chat-avatar [image]="operator.avatar"></chat-avatar>
            <h3 class="operator-name">
                {{ operator.name }}
            </h3>
        </div>

        <div
            class="chat-box-header"
            #fixedMsg
            id="box-header-2"
            style="display: none"
        >
            <div class="row">
                <div
                    *ngFor="let item of task.documents; let i = index"
                    class="col-1 mb-1"
                >
                    <div class="dot" [id]="i">{{ i + 1 }}</div>
                </div>
            </div>
            <div
                *ngIf="!!fixedMessage"
                [innerHTML]="fixedMessage"
                class="chat-box-header"
                style="
                    background-color: #3f51b5;
                    color: white;
                    font-size: larger;
                    height: auto;
                "
            ></div>
        </div>

        <div class="chat-box-main">
            <div class="chat-message-bottom" #bottom></div>
            <ng-container>
                <div #typing class="chat-message-received" style="width: 15%">
                    <div>
                        <chat-avatar
                            [image]="operator.avatar"
                            class="chat-message-from-avatar"
                        ></chat-avatar>
                        <div class="chat-message-text">
                            <div
                                class="type"
                                style="margin: 3px; margin-top: 0px"
                            >
                                <span></span>
                                <span></span>
                                <span></span>
                            </div>
                        </div>
                    </div>
                    <div class="chat-message-date"></div>
                    <div class="chat-message-date"></div>
                </div>
            </ng-container>

            <ng-container *ngFor="let message of messages">
                <div
                    class="chat-message"
                    [class.chat-message-received]="message.type === 'received'"
                    [@fadeIn]
                    [class.chat-message-sent]="message.type === 'sent'"
                >
                    <div>
                        <chat-avatar
                            [image]="message.from.avatar"
                            class="chat-message-from-avatar"
                        ></chat-avatar>
                        <div
                            class="chat-message-text"
                            [innerHTML]="message.text"
                        ></div>
                    </div>
                    <div class="chat-message-date">
                        {{ message.date | date : "short" }}
                    </div>
                </div>
            </ng-container>
        </div>

        <div #inputBox class="chat-box-footer">
            <div class="button-prompt" #buttonsNum style="display: none">
                <div
                    class="row container d-flex justify-content-end"
                    *ngIf="showCategoricalAnswers"
                >
                    <chat-input-categorical
                        class="col-12 text-end mr-2"
                        *ngFor="let item of categoricalInfo"
                        [value]="item.value"
                        [text]="item.label"
                        (send)="buttonInput($event)"
                    ></chat-input-categorical>
                    <!-- <button
                        *ngFor="let num of numberBtn"
                        type="button"
                        class="btn-secondary"
                        (click)="buttonInput(num)"
                    >
                        {{ num }}
                    </button> -->
                </div>
                <div
                    class="row container d-flex justify-content-end"
                    *ngIf="showMagnitudeAnswer"
                >
                    <chat-input-magnitude
                        [magnitudeInfo]="magnitudeInfo"
                        (send)="buttonInput($event)"
                    ></chat-input-magnitude>
                </div>
                <div
                    class="row container d-flex justify-content-end"
                    *ngIf="showIntervalAnswer"
                >
                    <chat-input-interval
                        [intervalInfo]="intervalInfo"
                        (updateSelectedValue)="updateInputValue($event)"
                    ></chat-input-interval>
                </div>
            </div>

            <div class="button-prompt" #buttonsYN style="display: none">
                <div class="row container d-flex justify-content-end pe-2">
                    <button
                        type="button"
                        class="btn-user-answer"
                        (click)="buttonInput('Yes')"
                    >
                        Yes
                    </button>
                    <button
                        type="button"
                        class="btn-user-answer"
                        (click)="buttonInput('No')"
                    >
                        No
                    </button>
                </div>
            </div>
            <div class="button-prompt" #buttonsCM style="display: none">
                <div class="row container d-flex justify-content-end pe-2">
                    <button
                        type="button"
                        class="btn-user-answer"
                        (click)="buttonInput('Confirm')"
                    >
                        Confirm
                    </button>
                    <button
                        type="button"
                        class="btn-user-answer"
                        (click)="buttonInput('Modify')"
                    >
                        Modify
                    </button>
                </div>
            </div>
        </div>
        <div>
            <chat-input
                (send)="sendMessage($event)"
                [pholder]="placeholderInput"
                [disableInput]="disableInput"
            >
            </chat-input>
        </div>
    </div>

    <div class="search-engine">
        <app-crowd-xplorer
            [task]="this.task"
            (selectedRowEmitter)="getUrl($event)"
            [resetEvent]="resetSearchEngine"
            [disableEvent]="disableSearchEngine"
            (resultEmitter)="storeSearchEngineRetrievedResponse($event)"
            (queryEmitter)="storeSearchEngineUserQuery($event)"
        ></app-crowd-xplorer>
    </div>
</div>
