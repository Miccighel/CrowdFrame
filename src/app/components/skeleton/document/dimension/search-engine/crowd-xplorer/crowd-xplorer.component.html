<mat-card
    id="crowd-xplorer-{{ digits }}"
    class="xplorer-body p-1"
    [formGroup]="searchForm"
>
    <div class="col-12 container">
        <div class="row my-2 container">
            <div class="col-12">
                <h2>Search Engine</h2>
            </div>
        </div>
        <div class="row container">
            <div class="col-8 col-lg-9 pe-0">
                <mat-form-field
                    id="search-textarea"
                    class="w-100"
                    appearance="outline"
                >
                    <mat-label>Insert your query</mat-label>
                    <input
                        #searchInput
                        matInput
                        type="search"
                        formControlName="query"
                        (keyup.enter)="performWebSearch(searchInput.value)"
                    />
                </mat-form-field>
            </div>
            <div class="col-lg-2 col-md-4 col-sm-4 mt-1" style="height: 60px">
                <button
                    *ngIf="!isSmallScreen"
                    class="h-100"
                    [ngClass]="!!searchInProgress ? 'searching' : ''"
                    mat-flat-button
                    color="primary"
                    [disabled]="
                        !query.valid ||
                        searchInProgress ||
                        (this.task.countdownsExpired[documentIndex] &&
                            this.task.settings.countdown_behavior ==
                                'disable_forms')
                    "
                    (click)="performWebSearch(searchInput.value)"
                >
                    <mat-icon *ngIf="!searchInProgress">search</mat-icon>

                    {{ !!searchInProgress ? "SEARCHING..." : "SEARCH" }}
                </button>
                <button
                    *ngIf="isSmallScreen"
                    class="h-100"
                    mat-flat-button
                    color="primary"
                    [disabled]="
                        !query.valid ||
                        searchInProgress ||
                        (this.task.countdownsExpired[documentIndex] &&
                            this.task.settings.countdown_behavior ==
                                'disable_forms')
                    "
                    (click)="performWebSearch(searchInput.value)"
                >
                    <mat-icon>search</mat-icon>
                </button>
            </div>
        </div>
        <div class="row container pe-0">
            <div class="col-12 pe-0">
                <mat-table [dataSource]="dataSource">
                    <mat-radio-group formControlName="urls">
                        <ng-container matColumnDef="{{ displayedColumns }}">
                            <mat-header-cell *matHeaderCellDef>
                                {{ resultsAmount }} results
                                found.</mat-header-cell
                            >
                            <mat-cell *matCellDef="let row; let i = index">
                                <p>
                                    <a
                                        target="_blank"
                                        href="{{ decodeURI(row.url) }}"
                                        >{{ row.name }}</a
                                    >
                                    <br />
                                    <span>{{ decodeURI(row.url) }}</span>
                                    <br />
                                    <span class="row-snippet">{{
                                        row.snippet
                                    }}</span>
                                </p>
                                <mat-radio-button
                                    labelPosition="before"
                                    [disabled]="
                                        this.task.countdownsExpired[
                                            documentIndex
                                        ] &&
                                        this.task.settings.countdown_behavior ==
                                            'disable_forms'
                                    "
                                    (change)="selectRow(row)"
                                    value="{{ row.url }}"
                                >
                                </mat-radio-button>
                            </mat-cell>
                        </ng-container>
                    </mat-radio-group>
                    <mat-header-row
                        *matHeaderRowDef="displayedColumns"
                    ></mat-header-row>
                    <mat-row
                        *matRowDef="let row; columns: displayedColumns"
                    ></mat-row>
                </mat-table>

                <mat-paginator
                    *ngIf="resultsFound"
                    [pageSize]="resultPageSize"
                    [pageSizeOptions]="resultPageSizeOptions"
                ></mat-paginator>
            </div>
        </div>
    </div>
</mat-card>
